<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Transactions</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <link rel="stylesheet" href="../../assets/css/admin_style_baru.css"> 
    <link rel="stylesheet" href="../../assets/css/transaksi_style.css"> 
</head>
<body>

<div class="admin-wrapper">
    <div id="sidebar-container"></div>

    <div class="main-content">
        <header class="content-header">
            <div>
                <h2>Transactions</h2>
                <p>Review and manage all customer orders.</p>
            </div>
        </header>

        <div class="dashboard-section">
            <div class="section-header">
                <div class="d-flex flex-wrap gap-2">
                    <input type="text" class="form-control" placeholder="Search order ID or customer..." style="width: 250px;">
                    <select class="form-select" style="width: 150px;">
                        <option selected>All Status</option>
                        <option value="completed">Completed</option>
                        <option value="pending">Pending</option>
                        <option value="shipped">Shipped</option>
                        <option value="failed">Failed</option>
                    </select>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table align-middle">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer</th>
                            <th>Amount</th>
                            <th>Date</th>
                            <th class="text-center">Status</th>
                            <th class="text-center">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="order-row" 
                            data-id="#1256" 
                            data-customer="Revan Putra" 
                            data-amount="Rp 150.000"
                            data-date="22 Agu 2025"
                            data-status="Completed"
                            data-items='[{"name":"Caladium Red Star","qty":2,"price":"Rp 75.000"}]'>
                            <td data-label="Order ID" class="fw-bold">#1256</td>
                            <td data-label="Customer">Revan Putra</td>
                            <td data-label="Amount" class="fw-bold text-success">+ Rp 150.000</td>
                            <td data-label="Date">22 Agu 2025</td>
                            <td data-label="Status" class="text-center"><span class="status-badge status-completed">Completed</span></td>
                            <td data-label="Action" class="text-center"><button class="btn btn-sm btn-outline-secondary btn-details">Details</button></td>
                        </tr>
                        <tr class="order-row"
                            data-id="#1255" 
                            data-customer="Andi Budi" 
                            data-amount="Rp 90.000"
                            data-date="22 Agu 2025"
                            data-status="Pending"
                            data-items='[{"name":"Peace Lily","qty":1,"price":"Rp 90.000"}]'>
                            <td data-label="Order ID" class="fw-bold">#1255</td>
                            <td data-label="Customer">Andi Budi</td>
                            <td data-label="Amount" class="fw-bold text-success">+ Rp 90.000</td>
                            <td data-label="Date">22 Agu 2025</td>
                            <td data-label="Status" class="text-center"><span class="status-badge status-pending">Pending</span></td>
                            <td data-label="Action" class="text-center"><button class="btn btn-sm btn-outline-secondary btn-details">Details</button></td>
                        </tr>
                        <tr class="order-row"
                            data-id="#1254" 
                            data-customer="Citra Lestari" 
                            data-amount="Rp 210.000"
                            data-date="21 Agu 2025"
                            data-status="Shipped"
                            data-items='[{"name":"Bibit Aglaonema","qty":1,"price":"Rp 120.000"},{"name":"Peace Lily","qty":1,"price":"Rp 90.000"}]'>
                            <td data-label="Order ID" class="fw-bold">#1254</td>
                            <td data-label="Customer">Citra Lestari</td>
                            <td data-label="Amount" class="fw-bold text-success">+ Rp 210.000</td>
                            <td data-label="Date">21 Agu 2025</td>
                            <td data-label="Status" class="text-center"><span class="status-badge status-shipped">Shipped</span></td>
                            <td data-label="Action" class="text-center"><button class="btn btn-sm btn-outline-secondary btn-details">Details</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="orderDetailsModal" tabindex="-1" aria-labelledby="modalTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalTitle">Order Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="row">
            <div class="col-6"><strong>Order ID:</strong></div>
            <div class="col-6 text-end" id="modalOrderId"></div>
            
            <div class="col-6"><strong>Customer:</strong></div>
            <div class="col-6 text-end" id="modalCustomer"></div>

            <div class="col-6"><strong>Date:</strong></div>
            <div class="col-6 text-end" id="modalDate"></div>
            
            <div class="col-6"><strong>Status:</strong></div>
            <div class="col-6 text-end" id="modalStatus"></div>
        </div>
        <hr>
        <h6>Items Ordered</h6>
        <div id="modalItems">
            </div>
        <hr>
        <div class="d-flex justify-content-between">
            <h6 class="fw-bold">Total Amount:</h6>
            <h6 class="fw-bold" id="modalTotalAmount"></h6>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="../../assets/js/app.js"></script>

<script>
$(document).ready(function(){
    // Siapkan modal Bootstrap
    const detailsModal = new bootstrap.Modal(document.getElementById('orderDetailsModal'));

    // Ketika tombol 'Details' diklik
    $('.btn-details').on('click', function(){
        const row = $(this).closest('.order-row');

        // 1. Ambil semua data dari atribut 'data-*' di <tr>
        const orderId = row.data('id');
        const customer = row.data('customer');
        const amount = row.data('amount');
        const date = row.data('date');
        const status = row.data('status');
        const items = row.data('items');

        // 2. Isi konten modal dengan data yang diambil
        $('#modalOrderId').text(orderId);
        $('#modalCustomer').text(customer);
        $('#modalDate').text(date);
        $('#modalTotalAmount').text(amount);
        // Untuk status, kita buat lagi badge-nya biar cakep
        $('#modalStatus').html(`<span class="status-badge status-${status.toLowerCase()}">${status}</span>`);

        // 3. Loop item produk dan tampilkan
        let itemsHtml = '';
        items.forEach(item => {
            itemsHtml += `
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span>${item.name} (x${item.qty})</span>
                    <span class="text-muted">${item.price}</span>
                </div>
            `;
        });
        $('#modalItems').html(itemsHtml);

        // 4. Tampilkan modal!
        detailsModal.show();
    });
});
</script>

</body>
</html>