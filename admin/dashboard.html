<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin - Dashboard</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../assets/css/admin_style.css" />

    <style>
        .dropdown-item p {
            white-space: normal; /* Memastikan teks panjang di notifikasi bisa wrap */
        }
    </style>
  </head>
  <body>
    <div class="admin-wrapper">
      <div id="sidebar-container"></div>
      <div id="overlay"></div>

      <div class="main-content">
        <header class="content-header">
          <div class="header-welcome">
            <h2>Dashboard</h2>
            <p>Here's what's happening with your store today.</p>
          </div>
          <div class="header-actions d-flex align-items-center">
            <input
              type="text"
              class="form-control me-2"
              placeholder="Search..."
            />
            <div class="dropdown">
              <button
                class="btn btn-light position-relative"
                type="button"
                id="notificationDropdown"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="fas fa-bell"></i>
                <span
                  class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                >
                  3
                  <span class="visually-hidden">unread messages</span>
                </span>
              </button>
              <ul
                class="dropdown-menu dropdown-menu-end p-2"
                aria-labelledby="notificationDropdown"
                style="min-width: 300px; max-height: 400px; overflow-y: auto;"
              >
                <li>
                  <h6 class="dropdown-header">Notifications</h6>
                </li>
                <li>
                  <a class="dropdown-item rounded d-flex align-items-start" href="#">
                    <i class="fas fa-shopping-cart text-success me-3 mt-1"></i>
                    <div>
                      <strong>Pesanan Baru #876369</strong>
                      <p class="mb-0 text-muted small">
                        dari Arsya Aji telah diterima.
                      </p>
                      <small class="text-muted">5 menit yang lalu</small>
                    </div>
                  </a>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a class="dropdown-item rounded d-flex align-items-start" href="#">
                    <i class="fas fa-box-open text-warning me-3 mt-1"></i>
                    <div>
                      <strong>Stok Rendah</strong>
                      <p class="mb-0 text-muted small">
                        Bibit Cabai Rawit Unggul tersisa 5 pcs.
                      </p>
                      <small class="text-muted">1 jam yang lalu</small>
                    </div>
                  </a>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a class="dropdown-item rounded d-flex align-items-start" href="#">
                    <i class="fas fa-user-plus text-primary me-3 mt-1"></i>
                    <div>
                      <strong>Customer Baru</strong>
                      <p class="mb-0 text-muted small">
                        Budi Santoso baru saja mendaftar.
                      </p>
                      <small class="text-muted">Kemarin</small>
                    </div>
                  </a>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a
                    class="dropdown-item text-center text-primary small"
                    href="#"
                    >Lihat semua notifikasi</a
                  >
                </li>
              </ul>
            </div>
          </div>
        </header>

        <div class="row">
          <div class="col-lg-3 col-md-6 mb-4">
            <div class="card stat-card-modern">
              <div class="card-body">
                <div
                  class="d-flex justify-content-between align-items-start mb-3"
                >
                  <div class="icon-wrapper primary-bg">
                    <i class="fas fa-dollar-sign"></i>
                  </div>
                  <span class="badge badge-success-light">
                    <i class="fas fa-arrow-up"></i> 20%
                  </span>
                </div>
                <p class="card-title-modern">Total Revenue</p>
                <h3 class="card-value-modern">$26,35,262</h3>
                <p class="card-text-modern text-muted">in last week</p>
              </div>
            </div>
          </div>

          <div class="col-lg-3 col-md-6 mb-4">
            <div class="card stat-card-modern">
              <div class="card-body">
                <div
                  class="d-flex justify-content-between align-items-start mb-3"
                >
                  <div class="icon-wrapper info-bg">
                    <i class="fas fa-file-invoice-dollar"></i>
                  </div>
                  <span class="badge badge-danger-light">
                    <i class="fas fa-arrow-down"></i> 1.8%
                  </span>
                </div>
                <p class="card-title-modern">Total Sales</p>
                <h3 class="card-value-modern">$56,35,262</h3>
                <p class="card-text-modern text-muted">in last week</p>
              </div>
            </div>
          </div>

          <div class="col-lg-3 col-md-6 mb-4">
            <div class="card stat-card-modern">
              <div class="card-body">
                <div
                  class="d-flex justify-content-between align-items-start mb-3"
                >
                  <div class="icon-wrapper warning-bg">
                    <i class="fas fa-box-open"></i>
                  </div>
                  <span class="badge badge-warning-light">
                    <i class="fas fa-arrow-up"></i> 1.8%
                  </span>
                </div>
                <p class="card-title-modern">Total Products</p>
                <h3 class="card-value-modern">$4,262</h3>
                <p class="card-text-modern text-muted">in last week</p>
              </div>
            </div>
          </div>

          <div class="col-lg-3 col-md-6 mb-4">
            <div class="card stat-card-modern">
              <div class="card-body">
                <div
                  class="d-flex justify-content-between align-items-start mb-3"
                >
                  <div class="icon-wrapper success-bg">
                    <i class="fas fa-money-bill-wave"></i>
                  </div>
                  <span class="badge badge-success-light">
                    <i class="fas fa-arrow-up"></i> 1.2%
                  </span>
                </div>
                <p class="card-title-modern">Total Expenses</p>
                <h3 class="card-value-modern">$35,262</h3>
                <p class="card-text-modern text-muted">in last week</p>
              </div>
            </div>
          </div>
        </div>

        <div class="row g-4 mt-2">
          <div class="col-lg-8">
            <div class="card dashboard-card h-100">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="card-title-custom">Sales Statistics</h5>
                <div class="dropdown">
                <button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" id="salesPeriodBtn" data-bs-toggle="dropdown">
                  This Week
                      </button>
                      <ul class="dropdown-menu" id="salesPeriodOptions">
                        <li><a class="dropdown-item" href="#" data-period="week">This Week</a></li>
                        <li><a class="dropdown-item" href="#" data-period="month">This Month</a></li>
                        <li><a class="dropdown-item" href="#" data-period="year">This Year</a></li>
                      </ul>
                    </div>
                  </div>
                <div class="chart-container" style="height: 300px">
                  <canvas id="salesChartNew"></canvas>
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-4">
            <div class="card dashboard-card h-100">
              <div class="card-body">
                <h5 class="card-title-custom mb-3">Orders Statistics</h5>
                <div
                  class="chart-container-doughnut mx-auto"
                  style="height: 200px; max-width: 200px"
                >
                  <canvas id="ordersChart"></canvas>
                </div>
                <div class="mt-4">
                  <ul class="list-unstyled">
                    <li
                      class="d-flex justify-content-between align-items-center mb-2"
                    >
                      <span
                        ><span class="legend-dot bg-success"></span>
                        Completed</span
                      >
                      <strong>1.2k</strong>
                    </li>
                    <li
                      class="d-flex justify-content-between align-items-center mb-2"
                    >
                      <span
                        ><span class="legend-dot bg-warning"></span>
                        Pending</span
                      >
                      <strong>345</strong>
                    </li>
                    <li
                      class="d-flex justify-content-between align-items-center"
                    >
                      <span
                        ><span class="legend-dot bg-danger"></span>
                        Canceled</span
                      >
                      <strong>123</strong>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12">
            <div class="card dashboard-card mt-4">
              <div class="card-body">
                <h5 class="card-title-custom mb-3">Product Statistics</h5>
                <ul class="list-group list-group-flush">
                  <li class="list-group-item product-stat-item">
                    <div class="d-flex align-items-center">
                      <img
                        src="https://i.pinimg.com/736x/80/5d/69/805d6987ade84a4bca8a8c6a5ec9092c.jpg"
                        alt="Product"
                        class="rounded me-3"
                      />
                      <div class="flex-grow-1">
                        <h6 class="mb-0">Bibit Cabai Rawit Unggul</h6>
                        <small class="text-muted">ID: #PROD-001</small>
                      </div>
                    </div>
                    <div class="ms-auto text-end" style="width: 200px">
                      <div class="d-flex justify-content-between">
                        <small>Sales</small>
                        <small class="fw-bold">1,250</small>
                      </div>
                      <div class="progress" style="height: 6px">
                        <div
                          class="progress-bar bg-primary"
                          role="progressbar"
                          style="width: 85%"
                          aria-valuenow="85"
                          aria-valuemin="0"
                          aria-valuemax="100"
                        ></div>
                      </div>
                    </div>
                  </li>
                  <li class="list-group-item product-stat-item">
                    <div class="d-flex align-items-center">
                      <img
                        src="https://i.pinimg.com/736x/7d/a7/b9/7da7b99ff39d5c65084802fc29de8f03.jpg"
                        alt="Product"
                        class="rounded me-3"
                      />
                      <div class="flex-grow-1">
                        <h6 class="mb-0">Pupuk Organik Cair</h6>
                        <small class="text-muted">ID: #PROD-002</small>
                      </div>
                    </div>
                    <div class="ms-auto text-end" style="width: 200px">
                      <div class="d-flex justify-content-between">
                        <small>Sales</small>
                        <small class="fw-bold">980</small>
                      </div>
                      <div class="progress" style="height: 6px">
                        <div
                          class="progress-bar bg-info"
                          role="progressbar"
                          style="width: 70%"
                          aria-valuenow="70"
                          aria-valuemin="0"
                          aria-valuemax="100"
                        ></div>
                      </div>
                    </div>
                  </li>
                  <li class="list-group-item product-stat-item">
                    <div class="d-flex align-items-center">
                      <img
                        src="https://i.pinimg.com/1200x/d7/65/92/d76592ddfd5d0e46d83a0f3ac188ce49.jpg"
                        alt="Product"
                        class="rounded me-3"
                      />
                      <div class="flex-grow-1">
                        <h6 class="mb-0">Alat Siram Otomatis</h6>
                        <small class="text-muted">ID: #PROD-003</small>
                      </div>
                    </div>
                    <div class="ms-auto text-end" style="width: 200px">
                      <div class="d-flex justify-content-between">
                        <small>Sales</small>
                        <small class="fw-bold">450</small>
                      </div>
                      <div class="progress" style="height: 6px">
                        <div
                          class="progress-bar bg-warning"
                          role="progressbar"
                          style="width: 45%"
                          aria-valuenow="45"
                          aria-valuemin="0"
                          aria-valuemax="100"
                        ></div>
                      </div>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="row g-4 mt-1">
          <div class="col-lg-8">
            <div class="card dashboard-card">
              <div class="card-body">
                <h5 class="card-title-custom mb-3">Recent Orders</h5>
                <div class="table-responsive">
                  <table class="table table-hover align-middle">
                    <thead class="table-light">
                      <tr>
                        <th scope="col">Order ID</th>
                        <th scope="col">Customer</th>
                        <th scope="col">Product</th>
                        <th scope="col">Qty</th>
                        <th scope="col">Price</th>
                        <th scope="col">Status</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="fw-bold">#876364</td>
                        <td>Revan Putra</td>
                        <td>Bibit Cabai</td>
                        <td>2</td>
                        <td class="fw-bold">Rp 50.000</td>
                        <td>
                          <span class="badge status-badge-completed"
                            >Completed</span
                          >
                        </td>
                      </tr>
                      <tr>
                        <td class="fw-bold">#876365</td>
                        <td>Citra Lestari</td>
                        <td>Pupuk Organik</td>
                        <td>1</td>
                        <td class="fw-bold">Rp 75.000</td>
                        <td>
                          <span class="badge status-badge-pending"
                            >Pending</span
                          >
                        </td>
                      </tr>
                      <tr>
                        <td class="fw-bold">#876366</td>
                        <td>Andi Budi</td>
                        <td>Alat Siram</td>
                        <td>1</td>
                        <td class="fw-bold">Rp 120.000</td>
                        <td>
                          <span class="badge status-badge-canceled"
                            >Canceled</span
                          >
                        </td>
                      </tr>
                      <tr>
                        <td class="fw-bold">#876367</td>
                        <td>Siska Amelia</td>
                        <td>Polybag (x50)</td>
                        <td>5</td>
                        <td class="fw-bold">Rp 25.000</td>
                        <td>
                          <span class="badge status-badge-completed"
                            >Completed</span
                          >
                        </td>
                      </tr>
                      <tr>
                        <td class="fw-bold">#876368</td>
                        <td>Arsya Aji</td>
                        <td>Benih Selada</td>
                        <td>10</td>
                        <td class="fw-bold">Rp 30.000</td>
                        <td>
                          <span class="badge status-badge-pending"
                            >Pending</span
                          >
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-4">
            <div class="card dashboard-card">
              <div class="card-body">
                <h5 class="card-title-custom mb-3">Top Customers</h5>
                <ul class="list-unstyled">
                  <li class="top-customer-item">
                    <img
                      src="https://via.placeholder.com/40"
                      alt="Customer"
                      class="rounded-circle"
                    />
                    <div class="customer-info">
                      <h6 class="mb-0">Revan Putra</h6>
                      <small class="text-muted">@revanputra</small>
                    </div>
                    <div class="customer-orders ms-auto">
                      <i class="fas fa-shopping-cart text-muted me-2"></i>
                      <span class="fw-bold">125</span>
                    </div>
                  </li>
                  <li class="top-customer-item">
                    <img
                      src="https://via.placeholder.com/40"
                      alt="Customer"
                      class="rounded-circle"
                    />
                    <div class="customer-info">
                      <h6 class="mb-0">Citra Lestari</h6>
                      <small class="text-muted">@citra</small>
                    </div>
                    <div class="customer-orders ms-auto">
                      <i class="fas fa-shopping-cart text-muted me-2"></i>
                      <span class="fw-bold">98</span>
                    </div>
                  </li>
                  <li class="top-customer-item">
                    <img
                      src="https://via.placeholder.com/40"
                      alt="Customer"
                      class="rounded-circle"
                    />
                    <div class="customer-info">
                      <h6 class="mb-0">Andi Budi</h6>
                      <small class="text-muted">@andib</small>
                    </div>
                    <div class="customer-orders ms-auto">
                      <i class="fas fa-shopping-cart text-muted me-2"></i>
                      <span class="fw-bold">76</span>
                    </div>
                  </li>
                  <li class="top-customer-item">
                    <img
                      src="https://via.placeholder.com/40"
                      alt="Customer"
                      class="rounded-circle"
                    />
                    <div class="customer-info">
                      <h6 class="mb-0">Siska Amelia</h6>
                      <small class="text-muted">@siska_a</small>
                    </div>
                    <div class="customer-orders ms-auto">
                      <i class="fas fa-shopping-cart text-muted me-2"></i>
                      <span class="fw-bold">54</span>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="../assets/js/admin_script.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
  // --- FUNGSI SEARCH BAR (TETAP ADA) ---
  const searchInput = document.getElementById("searchInput");
  if (searchInput) {
    searchInput.addEventListener("keyup", function (event) {
      if (event.key === "Enter") {
        const query = searchInput.value.trim();
        if (query) {
          window.location.href = `search-results.html?q=${encodeURIComponent(query)}`;
        }
      }
    });
  }

  // --- GRAFIK (CHARTS) DENGAN DATA DINAMIS ---

  // 1. Siapkan semua data untuk Sales Statistics
  const salesData = {
    week: {
      labels: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
      sales: [65, 59, 80, 81, 56, 55, 40],
      revenue: [28, 48, 40, 19, 86, 27, 90],
    },
    month: {
      labels: ["Week 1", "Week 2", "Week 3", "Week 4"],
      sales: [350, 410, 380, 500],
      revenue: [180, 220, 190, 250],
    },
    year: {
      labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul"],
      sales: [500, 450, 600, 700, 550, 650, 750],
      revenue: [250, 220, 300, 350, 270, 320, 370],
    },
  };

  // 2. Inisialisasi variabel chart di luar agar bisa diakses
  let salesChart;
  
  // 3. Buat fungsi untuk mengupdate grafik
  const updateSalesChart = (period) => {
    if (!salesChart) return; // Pastikan chart sudah ada
    const data = salesData[period];
    salesChart.data.labels = data.labels;
    salesChart.data.datasets[0].data = data.sales;
    salesChart.data.datasets[1].data = data.revenue;
    salesChart.update();
  };


  // Inisialisasi Chart.js untuk Sales Statistics
  const salesChartCanvasNew = document.getElementById("salesChartNew");
  if (salesChartCanvasNew) {
    const ctxSales = salesChartCanvasNew.getContext("2d");
    // Gunakan 'let' dan simpan instance chart ke variabel 'salesChart'
    salesChart = new Chart(ctxSales, {
      type: "line",
      data: {
        labels: salesData.week.labels, // Data awal: Mingguan
        datasets: [
          {
            label: "Sales",
            data: salesData.week.sales, // Data awal: Mingguan
            fill: false,
            borderColor: "#235347",
            tension: 0.4,
            pointBackgroundColor: "#235347",
            pointRadius: 5,
          },
          {
            label: "Revenue",
            data: salesData.week.revenue, // Data awal: Mingguan
            fill: false,
            borderColor: "#8EB69B",
            tension: 0.4,
            pointBackgroundColor: "#8EB69B",
            pointRadius: 5,
          },
        ],
      },
      options: { /* Opsi chart tetap sama */
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { position: "top", align: "end", labels: { usePointStyle: true, boxWidth: 8, color: "#051F20" }}},
        scales: {
          y: { beginAtZero: true, ticks: { color: "#163832" }, grid: { color: "#DAF1DE" } },
          x: { ticks: { color: "#163832" } },
        },
      },
    });
  }
  
  // 4. Tambahkan event listener untuk dropdown
  const salesPeriodBtn = document.getElementById('salesPeriodBtn');
  const salesPeriodOptions = document.getElementById('salesPeriodOptions');

  if (salesPeriodOptions && salesPeriodBtn) {
    salesPeriodOptions.addEventListener('click', (event) => {
        if (event.target.tagName === 'A') {
            event.preventDefault();
            const period = event.target.dataset.period;
            const periodText = event.target.textContent;
            
            // Update teks tombol
            salesPeriodBtn.textContent = periodText;
            
            // Panggil fungsi update
            updateSalesChart(period);
        }
    });
  }


  // Chart.js untuk Orders Statistics (Tidak Berubah)
  const ordersChartCanvas = document.getElementById("ordersChart");
  if (ordersChartCanvas) {
    const ctxOrders = ordersChartCanvas.getContext("2d");
    new Chart(ctxOrders, {
      type: "doughnut",
      data: {
        labels: ["Completed", "Pending", "Canceled"],
        datasets: [
          {
            label: "Orders",
            data: [1200, 345, 123],
            backgroundColor: ["#235347", "#ffc107", "#dc3545"],
            borderColor: "#FFFFFF",
            borderWidth: 4,
            hoverOffset: 8,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: "75%",
        plugins: {
          legend: {
            display: false,
          },
        },
      },
    });
  }
});
    </script>
  </body>
</html>